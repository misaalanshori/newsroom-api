[request_definition]
# r = User, Object, Action
r = sub, obj, act

[policy_definition]
# p = Role, ResourceType, Scope, OwnerConstraint, Action
p = role, res, scope, own, act

[role_definition]
# Hierarchical Roles (e.g. Admin inherits from Editor)
g = _, _

[policy_effect]
e = some(where (p.eft == allow))

[matchers]
# 1. ROLE: Check if User's role inherits from Policy role, OR direct user permission
# 2. RESOURCE: Check if the Object's type matches the Policy's resource type
# 3. ACTION: Check if the action matches
# 4. SCOPE: Allow if Policy is 'global' OR Departments match
# 5. OWNER: Allow if Policy is 'any' OR User ID matches Writer ID

m = (g(r.sub.role, p.role) || p.role == ("user:" + r.sub.id)) && \
    r.obj.type == p.res && \
    r.act == p.act && \
    (p.scope == "global" || r.sub.department == r.obj.department) && \
    (p.own == "any" || r.sub.id == r.obj.writer)